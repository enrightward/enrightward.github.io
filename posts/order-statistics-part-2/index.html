<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Order statistics — Part 2: General formulae for PDFs and expectations" /><meta name="author" content="Stephen Enright-Ward" /><meta property="og:locale" content="en_US" /><meta name="description" content="A minimal, portfolio, sidebar, bootstrap Jekyll theme with responsive web design and focuses on text presentation." /><meta property="og:description" content="A minimal, portfolio, sidebar, bootstrap Jekyll theme with responsive web design and focuses on text presentation." /><link rel="canonical" href="https://enrightward.github.io/enrightward.github.io/posts/order-statistics-part-2/" /><meta property="og:url" content="https://enrightward.github.io/enrightward.github.io/posts/order-statistics-part-2/" /><meta property="og:site_name" content="Logical Quantifier" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-03-07T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Order statistics — Part 2: General formulae for PDFs and expectations" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@Stephen Enright-Ward" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"A minimal, portfolio, sidebar, bootstrap Jekyll theme with responsive web design and focuses on text presentation.","url":"https://enrightward.github.io/enrightward.github.io/posts/order-statistics-part-2/","@type":"BlogPosting","headline":"Order statistics — Part 2: General formulae for PDFs and expectations","dateModified":"2021-03-11T09:00:54+01:00","datePublished":"2021-03-07T00:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://enrightward.github.io/enrightward.github.io/posts/order-statistics-part-2/"},"author":{"@type":"Person","name":"Stephen Enright-Ward"},"@context":"https://schema.org"}</script><title>Order statistics — Part 2: General formulae for PDFs and expectations | Logical Quantifier</title><link rel="shortcut icon" href="/enrightward.github.io/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/enrightward.github.io/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/enrightward.github.io/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/enrightward.github.io/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/enrightward.github.io/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/enrightward.github.io/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/enrightward.github.io/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/enrightward.github.io/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/enrightward.github.io/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/enrightward.github.io/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/enrightward.github.io/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/enrightward.github.io/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/enrightward.github.io/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/enrightward.github.io/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/enrightward.github.io/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/enrightward.github.io/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/enrightward.github.io/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/enrightward.github.io/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/enrightward.github.io/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/enrightward.github.io/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/enrightward.github.io/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/enrightward.github.io/assets/js/dist/post.min.js"></script> <script defer src="/enrightward.github.io/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/enrightward.github.io/" alt="avatar" class="mx-auto"> <img src="https://cdn.jsdelivr.net/gh/enrightward/blog-images/abacus.svg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/enrightward.github.io/">Logical Quantifier</a></div><div class="site-subtitle font-italic">A statistics, machine learning and mathematics blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/enrightward.github.io/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/enrightward.github.io/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/enrightward.github.io/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/enrightward.github.io/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/enrightward.github.io/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/enrightward" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/enrightward.github.io/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/enrightward.github.io/"> Posts </a> </span> <span>Order statistics — Part 2: General formulae for PDFs and expectations</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Order statistics — Part 2: General formulae for PDFs and expectations</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Mar 7, 2021, 12:00 AM +0100" > Mar 7 <i class="unloaded">2021-03-07T00:00:00+01:00</i> </span> by <span class="author"> Stephen Enright-Ward </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, Mar 11, 2021, 9:00 AM +0100" > Mar 11 <i class="unloaded">2021-03-11T09:00:54+01:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2609 words">14 min</span></div></div><div class="post-content"><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/enrightward.github.io/assets/img/order-statistics/part2/dimprog.png" alt="Desktop View" /></p><h2 id="1-introduction">1. Introduction</h2><p>In the <a href="https://enrightward.github.io/enrightward.github.io/posts/order-statistics-part-1/">last post</a>, we defined the <em>order statistics</em> of a collection of iid random variables \(X_{1}, \ldots, X_{n}\), to try and answer questions like “What’s the expected value of \(\max( \{ X_{1}, \ldots, X_{n} \} )\)?”, or more generally “what is \(\mathbb{E}[(X_{(k)})]\)?”, where \(X_{(k)}\) is defined by the property:</p><p>\begin{equation} X_{(1)} \le X_{(2)} \le \ldots \le X_{(n)}. \end{equation}</p><p>We investigated, in the special case where \(X_{i} \sim U(0, 1)\), the values of \(\mathbb{E}[(X_{(k)})]\) for \(1 \le n \le 9\) and \(1 \le k \le n\). By writing simple code to compute sample statistics, we conjectured that</p><p>\begin{equation} \mathbb{E}[(X_{(k)})] = \frac{k}{n+1} \cdot \end{equation}</p><p>We also proved this conjecture mathematically for \(n = 1, 2\), in part using a 2D scatter plot understand the CDF \(F\) in the two-variable case, then passing to the PDF \(f\) by using the <a href="https://en.wikipedia.org/wiki/Fundamental_theorem_of_calculus">Fundamental Theorem of Calculus</a>. By the end of this post, we will generalise these results, deriving a formula for \(\mathbb{E}[(X_{(k)})]\) for any \(n\) and for all \(1 \le k \le n\), for arbitrary common PDF \(f\) of the \(X_{i}\). This general formula will not be a closed formula — it will be an integral over a summation — but it will depend only on \(n\), the PDF \(f\) and the CDF \(F\). In the special case where the \(X_{i}\) are uniformly distributed on the unit interval, it will allow us to recover the formula \(\mathbb{E}[(X_{(k)})] = \frac{k}{n+1}\). However, we will wait to the <a href="https://enrightward.github.io/enrightward.github.io/posts/order-statistics-part-3/">next post</a> to recover this formula.</p><p>Before attacking the general proof, we will examine one last special case using code: Consider three variables \(X_{1}, X_{2}\) and \(X_{3}\) all \(\sim U(0, 1)\).</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.mlab</span> <span class="k">as</span> <span class="n">mlab</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>

<span class="k">def</span> <span class="nf">sample_uniform</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="s">"""Sample an `n`-tuple `m` times from the 
    uniform distribution on the unit interval"""</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">random</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">order_filter_3d</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">limit</span><span class="p">):</span>
    <span class="s">"""Given a 3-dimensional, 3 x N numpy array `samples`, an integer 
    `k` in {0, 1, 2, 3} and a real number `limit` in [0, 1], returns the 
    3 x M subarray of `samples` for which each column vector has exactly 
    `k` entries &lt;= `limit`."""</span>
    <span class="c1"># `k` must be an integer in {0, 1, 2}.
</span>    <span class="k">assert</span> <span class="n">k</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="mi">3</span>
    <span class="n">filtered_samples</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="c1"># sample is a 3 x N array =&gt; sample.transpose() is 
</span>    <span class="c1"># N X 3, so its elements are 3D.
</span>    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">.</span><span class="n">transpose</span><span class="p">():</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">sample</span>
        <span class="c1"># how many of {x, y, z} are &lt;= `limit`?
</span>        <span class="n">num_lte_limit</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">limit</span><span class="p">,</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="n">limit</span><span class="p">,</span> <span class="n">z</span> <span class="o">&lt;=</span> <span class="n">limit</span><span class="p">])</span>

        <span class="c1"># if this number equals `k`, add the sample
</span>        <span class="k">if</span> <span class="n">num_lte_limit</span> <span class="o">==</span> <span class="n">k</span><span class="p">:</span>
            <span class="n">filtered_samples</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">])</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">filtered_samples</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">set_ax_values</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">limit</span><span class="p">):</span>
    <span class="s">"""Helper function to label `ax`."""</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'X_1'</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'X_2'</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s">'X_3'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Regions where X_(k) &lt; {}, colour-coded by k in [0, 1, 2, 3]'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">limit</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">plot_3d</span><span class="p">(</span><span class="n">region_samples</span><span class="p">,</span> <span class="n">dotwidth</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
    <span class="s">"""Given a list `region_samples` of 3 x N numpy arrays living 
    in [0, 1] x [0, 1] x [0, 1], plot the 3D points in each array with a 
    separate colour scheme. Each point has thickness `dotwidth` 
    and `limit` is used only to label the graph."""</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s">'3d'</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">set_zlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
    <span class="n">set_ax_values</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">limit</span><span class="p">)</span>
    <span class="n">cmaps</span> <span class="o">=</span> <span class="p">[</span><span class="s">'magma'</span><span class="p">,</span> <span class="s">'viridis'</span><span class="p">,</span> <span class="s">'winter'</span><span class="p">]</span>
    
    <span class="c1"># display each region_sample in `region_samples`
</span>    <span class="c1"># on the same axis, but with a separate colour scheme.
</span>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">region_sample</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">region_samples</span><span class="p">):</span>
        <span class="n">xs</span> <span class="o">=</span> <span class="n">region_sample</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="n">region_sample</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">zs</span> <span class="o">=</span> <span class="n">region_sample</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmaps</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">cmaps</span><span class="p">)]</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">zs</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">xs</span><span class="o">+</span><span class="n">ys</span><span class="o">+</span><span class="n">zs</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">dotwidth</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><h2 id="2-visualising-mathbbprx_k-le-x-in-three-dimensions">2. Visualising \(\mathbb{Pr}(X_{(k)} \le x)\) in three dimensions</h2><p>As in the previous post, let’s use the above code to visualise the regions where \(X_{(k)} \le x\), for \(k = 1, 2, 3\). The volumes of these regions will be the probabilities \(\mathbb{Pr}(X_{(k)} \le x)\).</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="c1"># sample 100,000 points to cover the unit square
</span><span class="n">num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">)</span>
<span class="n">dotwidth</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">random</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="n">num</span><span class="p">))</span>

<span class="c1"># we're interested in which points have zero, one 
# two, or three coordinates &lt;= 0.3
</span><span class="n">limit</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="c1">#ks = [0, 1, 2, 3]
</span><span class="n">ks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">region_samples</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># For each k in [0, 1, 2, 3], filter for the the 3D columns in 
# `samples` having exactly `k` coordinates &lt;= 0.3.
</span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ks</span><span class="p">:</span>
    <span class="n">filtered_samples</span> <span class="o">=</span> <span class="n">order_filter_3d</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">limit</span><span class="p">)</span>
    <span class="n">region_samples</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">filtered_samples</span><span class="p">)</span>

<span class="n">theta</span> <span class="o">=</span> <span class="mi">45</span>
<span class="n">phi</span> <span class="o">=</span> <span class="mi">45</span>
<span class="n">plot_3d</span><span class="p">(</span><span class="n">region_samples</span><span class="p">,</span> <span class="n">dotwidth</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/enrightward.github.io/assets/img/order-statistics/part2/order_stats_3d_front.png" alt="png" /></p><p>Let’s show the same plot, but looking back from the opposite side of the far corner:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">theta</span> <span class="o">=</span> <span class="o">-</span><span class="mi">45</span>
<span class="n">phi</span> <span class="o">=</span> <span class="mi">225</span>
<span class="n">plot_3d</span><span class="p">(</span><span class="n">region_samples</span><span class="p">,</span> <span class="n">dotwidth</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/enrightward.github.io/assets/img/order-statistics/part2/order_stats_3d_back.png" alt="png" /></p><h2 id="3-analysing-the-visulation-computing-cdfs">3. Analysing the visulation: Computing CDFs</h2><p>In the scatter plot above, we uniformly sampled 100,000 points \(P = (x_{1}, x_{2}, x_{3})\) from the unit cube, and coloured them according to whether none, only one, two or all three of the coordinates \(x_{i}\) were less than the (arbitrarily-chosen) cutoff value \(x = 0.3\). The regions defined by these colours define all the ways these inequality conditions can be satisfied, and so their volumes are the probabilites these conditions hold, for \(P\) randomly sampled. Specifically:</p><ol><li>The <span style="color:cyan">blue cube region \(R_{3}(x)\)</span> (“the fattened origin”) in the back corner is defined by the condition: \begin{equation} R_{3}(x) := \left\{ (x_{1}, x_{2}, x_{3}) \in \mathbb{R}^{3} \mid x_{1}, x_{2}, x_{3} \le x \right\}, \end{equation} so it follows \begin{equation} \mathbb{Pr}(X_{(1)}, X_{(2)}, X_{(3)} \le x) = \mathbb{Pr}(X_{1}, X_{2}, X_{3} \le x) = \textrm{vol}(R_{3}(x)) = x^{3}. \end{equation}<li>The <span style="color:green">three green rectangular prisms</span> (the “fattened axes”) are defined by the conditions: \begin{align} R_{2}^{1}(x) &amp;:= \left\{ (x_{1}, x_{2}, x_{3}) \in \mathbb{R}^{3} \mid x_{2}, x_{3} \le x \le x_{1} \right\}, \newline R_{2}^{2}(x) &amp;:= \left\{ (x_{1}, x_{2}, x_{3}) \in \mathbb{R}^{3} \mid x_{1}, x_{3} \le x \le x_{2} \right\}, \newline R_{2}^{3}(x) &amp;:= \left\{ (x_{1}, x_{2}, x_{3}) \in \mathbb{R}^{3} \mid x_{1}, x_{2} \le x \le x_{3} \right\}. \end{align} The union \(R_{2}(x)\) of these three sets is: \begin{align} R_{2}(x) := \left\{ (x_{1}, x_{2}, x_{3}) \in \mathbb{R}^{3} \mid x_{i}, x_{j} \le x \le x_{k} \textrm{ for } 1 \le i, j, k \le 3 \right\}. \end{align} For any of the \(R_{2}^{i}(x)\), two of the three coordinates are confined to an \(x \times x\) square, and the last one takes values between \(x\) and \(1\). So, \(\textrm{vol}(R_{2}^{i}(x)) = x^{2}(1-x)\), implying that \begin{align} \mathbb{Pr}(X_{(1)}, X_{(2)} \le x \le X_{(3)}) = \textrm{vol}(R_{2}(x)) = 3x^{2}(1-x). \end{align}<li>The <span style="color:orange">three orange pieces of toast</span> (the “fattened planes”) are defined by the conditions: \begin{align} R_{1}^{1}(x) &amp;:= \left\{ (x_{1}, x_{2}, x_{3}) \in \mathbb{R}^{3} \mid x_{1} \le x \le x_{2}, x_{3} \right\}, \newline R_{1}^{2}(x) &amp;:= \left\{ (x_{1}, x_{2}, x_{3}) \in \mathbb{R}^{3} \mid x_{2} \le x \le x_{1}, x_{3} \right\}, \newline R_{1}^{3}(x) &amp;:= \left\{ (x_{1}, x_{2}, x_{3}) \in \mathbb{R}^{3} \mid x_{3} \le x \le x_{1}, x_{2} \right\}. \end{align} The union \(R_{1}(x)\) of these three sets is: \begin{align} R_{2}(x) := \left\{ (x_{1}, x_{2}, x_{3}) \in \mathbb{R}^{3} \mid x_{i} \le x \le x_{j}, \le x_{k} \textrm{ for } 1 \le i, j, k \le 3 \right\}. \end{align} For any of the \(R_{1}^{i}(x)\), two of the three coordinates are confined to an \((1 - x) \times (1 - x)\) square, and the last one is at most \(x\). It follows \(\textrm{vol}(R_{1}^{i}(x)) = x(1-x)^{2}\), implying that \begin{align} \mathbb{Pr}(X_{(1)} \le x \le X_{(2)}, X_{(3)}) = \textrm{vol}(R_{1}(x)) = 3x(1-x)^{2}. \end{align}</ol><h2 id="4-key-observations">4. Key observations</h2><p>The probabilities calculated above describe three conditions, for a fixed \(0 \le x \le 1\):</p><p>\begin{align} C_{1}: &amp; X_{(1)} \le x \le X_{(2)}, X_{(3)} \newline C_{2}: &amp; X_{(1)} \le X_{(2)} \le x \le X_{(3)} \newline C_{3}: &amp; X_{(1)} \le X_{(2)} \le X_{(3)} \le x. \end{align}</p><p>They are mutually exclusive and, taken together, describe all the ways at least one of the \(X_{(k)}\) can be less than or equal to \(x\). It follows that we can use these conditions, together with the probability calculations above, to compute CDFs for the \(X_{(k)}\). Indeed, \(x\) exceeds \(X_{(1)}\) in all cases, so:</p><p>\begin{align} F_{X_{(1)}}(x) &amp;= \mathbb{Pr}(X_{(1)} \le x) = \mathbb{Pr}(C_{1} \textrm{ or } C_{2} \textrm{ or } C_{3}) = \mathbb{Pr}(C_{1}) + \mathbb{Pr}(C_{2}) + \mathbb{Pr}(C_{3}) \newline &amp;= 3x(1-x)^{2} + 3x^{2}(1-x) + x^{3} = x^{3} - 3x^{2} + 3x. \end{align}</p><p>However, \(x\) exceeds \(X_{(2)}\) only in the last two cases, and exceeds \(X_{(1)}\) only in the last case. Hence:</p><p>\begin{align} F_{X_{(2)}}(x) &amp;= \mathbb{Pr}(X_{(2)} \le x) = \mathbb{Pr}(C_{2}) + \mathbb{Pr}(C_{3}) = 3x^{2}(1-x) + x^{3} = 3x^{2} - 2x^{3}, \newline F_{X_{(3)}}(x) &amp;= \mathbb{Pr}(X_{(3)} \le x) = \mathbb{Pr}(C_{3}) = x^{3}. \end{align}</p><h2 id="5-deriving-pdfs-from-cdfs-using-the-ftc-case-n--3">5. Deriving PDFs from CDFs using the FTC (case \(n = 3\))</h2><p>We have just computed:</p><p>\begin{align} F_{X_{(1)}}(x) &amp;= \mathbb{Pr}(X_{(1)} \le x) = x^{3} - 3x^{2} + 3x, \newline F_{X_{(2)}}(x) &amp;= \mathbb{Pr}(X_{(2)} \le x) = 3x^{2} - 2x^{3}, \newline F_{X_{(3)}}(x) &amp;= \mathbb{Pr}(X_{(3)} \le x) = x^{3}. \end{align}</p><p>By the FTC, if follows that:</p><p>\begin{align} f_{X_{(1)}}(x) &amp;= \frac{d}{dx} \left( F_{X_{(1)}}(x) \right) = 3x^{2} - 6x + 3, \newline f_{X_{(2)}}(x) &amp;= \frac{d}{dx} \left( F_{X_{(2)}}(x) \right) = 6x - 6x^{2}, \newline f_{X_{(3)}}(x) &amp;= \frac{d}{dx} \left( F_{X_{(3)}}(x) \right) = 3x^{2}. \end{align}</p><p>As a result, we have:</p><p>\begin{align} \mathbb{E}(X_{(1)}) &amp;= \int_{0}^{1} x \, f_{X_{(1)}}(x) \, dx = \int_{0}^{1} (3x^{3} - 6x^{2} + 3x) \, dx = \left \lbrack \frac{3x^{4}}{4} - 2x^{3} + \frac{3x^{2}}{2} \right \rbrack_{0}^{1} = \frac{1}{4}, \newline \mathbb{E}(X_{(2)}) &amp;= \int_{0}^{1} x \, f_{X_{(2)}}(x) \, dx = \int_{0}^{1} (6x^{2} - 6x^{3}) \, dx = \left \lbrack 2x^{3} - \frac{3x^{4}}{2} \right \rbrack_{0}^{1} = \frac{1}{2}, \newline \mathbb{E}(X_{(3)}) &amp;= \int_{0}^{1} x \, f_{X_{(3)}}(x) \, dx = \int_{0}^{1} 3x^{3} \, dx = \left \lbrack \frac{3x^{4}}{4} \right \rbrack_{0}^{1} = \frac{3}{4} \cdot \end{align}</p><p>This confirms the hypothesis for \(n = 3\).</p><h2 id="6-the-formula-for-general-n-and-k-and-arbitrary-f">6. The formula for general \(n\) and \(k\), and arbitrary \(f\)</h2><p>For \(n \ge 4\), we can no longer visualise the component regions of \(X_{(k)} \le x\). However, it is straightforward to generalise the combinatorial methods and observations from Sections 3 and 4.</p><h3 id="61-enumerate-ways-the-x_k-can-be-at-most-x">6.1 Enumerate ways the \(X_{(k)}\) can be at most \(x\)</h3><p>For example, we now have \(n\) mutually exclusive conditions — one for each \(1 \le k \le n\) — to describe all the ways at least one of the \(X_{(k)}\) can be at most \(x\):</p><p>\begin{align} C_{1}: &amp; X_{(1)} \le x \le \ldots \le X_{(n)} \newline \vdots \newline C_{k}: &amp; X_{(1)} \le \ldots \le X_{(k)} \le x \le \ldots \le X_{(n)} \newline \vdots \newline C_{n}: &amp; X_{(1)} \le \ldots \le X_{(n)} \le x. \end{align}</p><h3 id="62-compute-mathbbprc_k-using-iid-assumption">6.2 Compute \(\mathbb{Pr}(C_{k})\) using iid assumption</h3><p>Since the \(X_{i}\) are iid by assumption, say with common CDF \(F_{X}\), we have:</p><p>\begin{align} \mathbb{Pr}(C_{k}) &amp;= \prod_{j=1}^{k} \mathbb{Pr}(X_{(j)} \le x) \times \prod_{j=k+1}^{n} \mathbb{Pr}(X_{(j)} \ge x) \newline &amp;= \binom{n}{k} F_{X}(x)^{k} (1 - F_{X}(x))^{n-k}. \end{align}</p><p>In this formula, the factors \(F_{X}(x)^{k}\) and \((1 - F_{X}(x))^{n-k}\) appear because \(\mathbb{Pr}(X_{(j)} \le x) = F_{X}(x)\) and \(\mathbb{Pr}(X_{(j)} \ge x) = 1 - F_{X}(x)\), since the \(X_{i}\) are iid with common CDF \(F_{X}\). The binomial coefficient appears because the condition \(C_{k}\) above can be realised in \(\binom{n}{k}\) different ways: One for each assignment of a \(k\)-subset of \(\{ 1, 2, \ldots, n \}\) to the subscripts \(X_{(1)} \le \ldots \le X_{(k)} \le x\).</p><h3 id="63-compute-cdf-f_x_kx-using-the-mathbbprc_k">6.3 Compute CDF \(F_{X_{(k)}}(x)\) using the \(\mathbb{Pr}(C_{k})\)</h3><p>As above, we can use the conditions \(C_{k}\) and associated probability formuale to compute CDFs for the \(X_{(k)}\). This time, we observe that \(X_{(k)} \le x\) precisely in conditions \(C_{k}\) through \(C_{n}\), and so:</p><p>\begin{equation} F_{X_{(k)}}(x) = \mathbb{Pr}(X_{(k)} \le x) = \sum_{j=k}^{n} \mathbb{Pr}(C_{j}) = \sum_{j=k}^{n} \binom{n}{j} F_{X}(x)^{j} (1 - F_{X}(x))^{n-j}. \end{equation}</p><h3 id="64-compute-pdf-f_x_kx-using-the-ftc">6.4 Compute PDF \(f_{X_{(k)}}(x)\) using the FTC</h3><p>We now compute the PDF \(f_{X_{(k)}}(x)\) using the FTC and the fact that \(F^{\prime}_{X}(x) = f_{X}(x)\). To ease the notation, I’ll make the substitution \(a := F_{X}(x)\) after the first line:</p><p>\begin{align} f_{X_{(k)}}(x) &amp;= F_{X_{(k)}}^{\prime}(x) = \sum_{j=k}^{n} \binom{n}{j} \big( j \cdot f_{X}(x) \, F_{X}(x)^{j-1} (1 - F_{X}(x))^{n-j} - (n-j) \cdot f_{X}(x) \, F_{X}(x)^{j} (1 - F_{X}(x))^{n-j-1} \big) \newline &amp;= f_{X}(x) \cdot \sum_{j=k}^{n} \binom{n}{j} a^{j-1} \, (1 - a)^{n-j-1} \big( j \cdot(1 - a) - (n-j) \cdot a \big) \newline &amp;= f_{X}(x) \cdot \sum_{j=k}^{n} \left\{ j \binom{n}{j} a^{j-1} \, (1 - a)^{n-j} - (n-j) \binom{n}{j} a^{j} \, (1 - a)^{n-j-1} \right\}. \end{align}</p><h3 id="65-simplify-pdf-with-combinatorial-identity">6.5 Simplify PDF with combinatorial identity</h3><p>This formula for \(f_{X_{(k)}}(x)\) looks complicated, but it turns out to “collapse” — successive terms cancel, and the last term is zero. To see this, we’ll view the summation — ignoring the term \(f_{X}(x)\) out the front, which for our purposes is constant and we will reinsert later — as a sum of differences \(A_{j} - B_{j}\), where</p><p>\begin{align} A_{j} &amp;:= j \binom{n}{j} a^{j-1} \, (1 - a)^{n-j}, \newline B_{j} &amp;:= (n-j) \binom{n}{j} a^{j} \, (1 - a)^{n-j-1}. \end{align}</p><p>The key things to notice are that \(B_{n} = 0\) (which is clear, since the coefficient \((n-j) = 0\) when \(j = n\)), and that \(A_{j+1} = B_{j}\), which we’ll prove shortly. This will imply that:</p><p>\begin{align} \sum_{j=k}^{n} \left( A_{j} - B_{j} \right) &amp;= A_{k} - B_{k} + A_{k+1} - B_{k+1} + \cdots + A_{n-1} - B_{n-1} + A_{n} - B_{n} \newline &amp;= A_{k} = k \binom{n}{k} a^{k-1} \, (1 - a)^{n-k}, \end{align}</p><p>and hence that \(f_{X_{(k)}}(x) = f_{X}(x) \cdot A_{k}\). To see that \(A_{j+1} = B_{j}\), note first the combinatorial identity:</p><p>\begin{align} \newline (j+1) \binom{n}{j+1} = \frac{n(j+1)}{(j+1)!(n - (j+1))!} = \frac{n}{j!(n - j - 1)!} = (n-j)\frac{n}{j!(n - j)!} = (n-j) \binom{n}{j}. \end{align}</p><p>It follows that:</p><p>\begin{align} A_{j+1} &amp;= (j+1) \binom{n}{j+1} a^{(j+1) - 1} \, (1 - a)^{n-(j+1)} = (n-j)\frac{n}{j!(n - j)!} a^{j} \, (1 - a)^{n-j-1} = B_{j}. \end{align}</p><h3 id="66-general-formulae-for-pdf-and-expectation">6.6 General formulae for PDF and expectation</h3><p>Putting all of this together, we have shown that the PDF \(f_{X_{(k)}}(x)\) is given by:</p><p>\begin{align} f_{X_{(k)}}(x) = k \binom{n}{k} f_{X}(x) \cdot F_{X}(x)^{k-1} \, (1 - F_{X}(x))^{n-k}. \end{align}</p><p>It follows that:</p><p>\begin{align} \mathbb{E}[X_{(k)}] &amp;= \int_{0}^{1} x \, f_{X_{(k)}}(x) \, dx \newline &amp;= k \binom{n}{k} \int_{0}^{1} x \cdot f_{X}(x) \cdot F_{X}(x)^{k-1} \, (1 - F_{X}(x))^{n-k} \, dx. \end{align}</p><p>This formula isn’t “closed”, because it includes an uncomputed integral. However, it is still useful, as it depends only on the PDF \(f_{X}\) and CDF \(F_{X}\).</p><h2 id="7-roundup">7. Roundup</h2><p>By doing some sample computations and visualisations with three iid variables \(X_{i} \sim U(0, 1)\), we guessed that</p><p>\begin{equation} \mathbb{E} \left \lbrack X_{(1)} \right \rbrack = \frac{1}{4}, \quad \mathbb{E} \left \lbrack X_{(2)} \right \rbrack = \frac{1}{2}, \quad \textrm{and} \quad \mathbb{E} \left \lbrack X_{(3)} \right \rbrack = \frac{3}{4}, \quad \end{equation}</p><p>then proved this mathematically, by writing down CDFs \(F_{X_{(k)}}(x)\), using the FTC to compute the PDFs \(f_{X_{(k)}}(x)\), then calculating \(\mathbb{E}[X_{(k)}]\) directly. Along the way, we made some combinatorial observations that generalised straightforwardly to the case of arbitrary \(n\), arbitrary \(1 \le k \le n\) and arbitrary common PDF \(f\) of the \(X_{i}\). This allowed us to write down the following general formulae:</p><p>\begin{align} F_{X_{(k)}}(x) &amp;= \sum_{j=k}^{n} \binom{n}{j} F_{X}(x)^{j} (1 - F_{X}(x))^{n-j}, \newline f_{X_{(k)}}(x) &amp;= k \binom{n}{k} f_{X}(x) \cdot F_{X}(x)^{k-1} \, (1 - F_{X}(x))^{n-k}, \newline \mathbb{E} \left \lbrack X_{(k)} \right \rbrack &amp;= k \binom{n}{k} \int_{0}^{1} x \cdot f_{X}(x) \cdot F_{X}(x)^{k-1} \, (1 - F_{X}(x))^{n-k} \, dx, \end{align}</p><p>which depend only on \(n, k, f_{X}\) and \(F_{X}\). <a href="https://enrightward.github.io/enrightward.github.io/posts/order-statistics-part-3/">Next post</a> we’ll round out the exposition of \(k^{\textrm{th}}\) order statistics by specialising these general formulae to the case of the uniform distribution \(U(0, 1)\). We will show that:</p><p>\begin{align} F_{X_{(k)}}(x) &amp;= \sum_{j=k}^{n} \binom{n}{j} x^{j} (1 - x)^{n-j}, \newline f_{X_{(k)}}(x) &amp;= k \binom{n}{k} x^{k-1} \, (1 - x)^{n-k}, \newline \mathbb{E} \left \lbrack X_{(k)} \right \rbrack &amp;= \frac{k}{n+1} \cdot \end{align}</p><p>The proof of the expectation formula will use <a href="https://en.wikipedia.org/wiki/Beta_function">beta functions</a> and <a href="https://en.wikipedia.org/wiki/Gamma_function">gamma functions</a>, but we will define these and prove the necessary properties inline.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/enrightward.github.io/categories/statistics/'>statistics</a>, <a href='/enrightward.github.io/categories/order-statistics/'>order statistics</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/enrightward.github.io/tags/statistics/" class="post-tag no-text-decoration" >statistics</a> <a href="/enrightward.github.io/tags/order-statistics/" class="post-tag no-text-decoration" >order statistics</a> <a href="/enrightward.github.io/tags/uniform-distribution/" class="post-tag no-text-decoration" >uniform distribution</a> <a href="/enrightward.github.io/tags/general-formula/" class="post-tag no-text-decoration" >general formula</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Order statistics — Part 2: General formulae for PDFs and expectations - Logical Quantifier&url=https://enrightward.github.io/enrightward.github.io/posts/order-statistics-part-2/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Order statistics — Part 2: General formulae for PDFs and expectations - Logical Quantifier&u=https://enrightward.github.io/enrightward.github.io/posts/order-statistics-part-2/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Order statistics — Part 2: General formulae for PDFs and expectations - Logical Quantifier&url=https://enrightward.github.io/enrightward.github.io/posts/order-statistics-part-2/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/enrightward.github.io/posts/convolutions-part-2/">Convolutions of RVs — Part 2: A linear combination of uniform RVs</a><li><a href="/enrightward.github.io/posts/order-statistics-part-3/">Order statistics — Part 3: Proof of expectation formula for uniform RVs</a><li><a href="/enrightward.github.io/posts/cross-entropy-part-2/">Cross entropy — Part 2: Convexity of the objective function</a><li><a href="/enrightward.github.io/posts/cross-entropy-part-1/">Cross entropy — Part 1: Introduction and definitions</a><li><a href="/enrightward.github.io/posts/order-statistics-part-2/">Order statistics — Part 2: General formulae for PDFs and expectations</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/enrightward.github.io/tags/statistics/">statistics</a> <a class="post-tag" href="/enrightward.github.io/tags/uniform-distribution/">uniform distribution</a> <a class="post-tag" href="/enrightward.github.io/tags/order-statistics/">order statistics</a> <a class="post-tag" href="/enrightward.github.io/tags/convolutions/">convolutions</a> <a class="post-tag" href="/enrightward.github.io/tags/cross-entropy/">cross entropy</a> <a class="post-tag" href="/enrightward.github.io/tags/beta-function/">beta function</a> <a class="post-tag" href="/enrightward.github.io/tags/convexity/">convexity</a> <a class="post-tag" href="/enrightward.github.io/tags/entropy/">entropy</a> <a class="post-tag" href="/enrightward.github.io/tags/expectation-formula/">expectation formula</a> <a class="post-tag" href="/enrightward.github.io/tags/ftc/">FTC</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/enrightward.github.io/posts/order-statistics-part-1/"><div class="card-body"> <span class="timeago small" > Mar 5 <i class="unloaded">2021-03-05T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Order statistics — Part 1: Introduction and definitions</h3><div class="text-muted small"><p> 1. Introduction On average, how tall is the tallest 8th grader in a class of 30 students, in the US? What is the value of the average winning bid in a Vickery Auction, where the highest bidder w...</p></div></div></a></div><div class="card"> <a href="/enrightward.github.io/posts/order-statistics-part-3/"><div class="card-body"> <span class="timeago small" > Mar 8 <i class="unloaded">2021-03-08T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Order statistics — Part 3: Proof of expectation formula for uniform RVs</h3><div class="text-muted small"><p> 1. Introduction In the last post, we proved the following general formulae, after conducting some numerical experiments to gain intuition: \begin{align} F_{X_{(k)}}(x) &amp;= \sum_{j=k}^{n} \bi...</p></div></div></a></div><div class="card"> <a href="/enrightward.github.io/posts/convolutions-part-1/"><div class="card-body"> <span class="timeago small" > Mar 14 <i class="unloaded">2021-03-14T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Convolutions of random variables — Part 1: Introduction</h3><div class="text-muted small"><p> 1. Introduction Suppose that \(X\) and \(Y\) are two continuous random variables. Given their PDFs PDFs \(f_{X}\) and \(f_{Y}\), how do you compute the \(f_{X + Y}\) of the sum of \(X+Y\)? In th...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/enrightward.github.io/posts/order-statistics-part-1/" class="btn btn-outline-primary" prompt="Older"><p>Order statistics — Part 1: Introduction and definitions</p></a> <a href="/enrightward.github.io/posts/order-statistics-part-3/" class="btn btn-outline-primary" prompt="Newer"><p>Order statistics — Part 3: Proof of expectation formula for uniform RVs</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/username">Stephen Enright-Ward</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/enrightward.github.io/tags/statistics/">statistics</a> <a class="post-tag" href="/enrightward.github.io/tags/uniform-distribution/">uniform distribution</a> <a class="post-tag" href="/enrightward.github.io/tags/order-statistics/">order statistics</a> <a class="post-tag" href="/enrightward.github.io/tags/convolutions/">convolutions</a> <a class="post-tag" href="/enrightward.github.io/tags/cross-entropy/">cross entropy</a> <a class="post-tag" href="/enrightward.github.io/tags/beta-function/">beta function</a> <a class="post-tag" href="/enrightward.github.io/tags/convexity/">convexity</a> <a class="post-tag" href="/enrightward.github.io/tags/entropy/">entropy</a> <a class="post-tag" href="/enrightward.github.io/tags/expectation-formula/">expectation formula</a> <a class="post-tag" href="/enrightward.github.io/tags/ftc/">FTC</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/enrightward.github.io/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://enrightward.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
