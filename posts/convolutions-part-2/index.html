<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Convolutions of RVs — Part 2: A linear combination of uniform RVs" /><meta name="author" content="Stephen Enright-Ward" /><meta property="og:locale" content="en_US" /><meta name="description" content="A minimal, portfolio, sidebar, bootstrap Jekyll theme with responsive web design and focuses on text presentation." /><meta property="og:description" content="A minimal, portfolio, sidebar, bootstrap Jekyll theme with responsive web design and focuses on text presentation." /><link rel="canonical" href="https://enrightward.github.io/enrightward.github.io/posts/convolutions-part-2/" /><meta property="og:url" content="https://enrightward.github.io/enrightward.github.io/posts/convolutions-part-2/" /><meta property="og:site_name" content="Logical Quantifier" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-03-16T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Convolutions of RVs — Part 2: A linear combination of uniform RVs" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@Stephen Enright-Ward" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"A minimal, portfolio, sidebar, bootstrap Jekyll theme with responsive web design and focuses on text presentation.","url":"https://enrightward.github.io/enrightward.github.io/posts/convolutions-part-2/","@type":"BlogPosting","headline":"Convolutions of RVs — Part 2: A linear combination of uniform RVs","dateModified":"2021-03-17T06:28:43+01:00","datePublished":"2021-03-16T00:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://enrightward.github.io/enrightward.github.io/posts/convolutions-part-2/"},"author":{"@type":"Person","name":"Stephen Enright-Ward"},"@context":"https://schema.org"}</script><title>Convolutions of RVs — Part 2: A linear combination of uniform RVs | Logical Quantifier</title><link rel="shortcut icon" href="/enrightward.github.io/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/enrightward.github.io/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/enrightward.github.io/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/enrightward.github.io/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/enrightward.github.io/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/enrightward.github.io/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/enrightward.github.io/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/enrightward.github.io/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/enrightward.github.io/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/enrightward.github.io/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/enrightward.github.io/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/enrightward.github.io/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/enrightward.github.io/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/enrightward.github.io/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/enrightward.github.io/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/enrightward.github.io/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/enrightward.github.io/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/enrightward.github.io/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/enrightward.github.io/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/enrightward.github.io/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/enrightward.github.io/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/enrightward.github.io/assets/js/dist/post.min.js"></script> <script defer src="/enrightward.github.io/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/enrightward.github.io/" alt="avatar" class="mx-auto"> <img src="https://cdn.jsdelivr.net/gh/enrightward/blog-images/abacus.svg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/enrightward.github.io/">Logical Quantifier</a></div><div class="site-subtitle font-italic">A statistics, machine learning and mathematics blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/enrightward.github.io/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/enrightward.github.io/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/enrightward.github.io/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/enrightward.github.io/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/enrightward.github.io/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/enrightward" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/enrightward.github.io/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/enrightward.github.io/"> Posts </a> </span> <span>Convolutions of RVs — Part 2: A linear combination of uniform RVs</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Convolutions of RVs — Part 2: A linear combination of uniform RVs</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Mar 16, 2021, 12:00 AM +0100" > Mar 16 <i class="unloaded">2021-03-16T00:00:00+01:00</i> </span> by <span class="author"> Stephen Enright-Ward </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Wed, Mar 17, 2021, 6:28 AM +0100" > Mar 17 <i class="unloaded">2021-03-17T06:28:43+01:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1656 words">9 min</span></div></div><div class="post-content"><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/enrightward.github.io/assets/img/convolutions/mesa.jpeg" alt="Desktop View" /></p><h2 id="1-introduction">1. Introduction</h2><p>In the <a href="https://enrightward.github.io/enrightward.github.io/posts/convolutions-part-1/">last post</a>, we defined the <em>convolution</em> of the PDFs \(f_{X}\) and \(f_{Y}\) of two independent, continuous random variables \(X\) and \(Y\), and showed that it computed the PDF \(f_{X + Y}\) of the sum of \(X+Y\). Minor adaptations also yielded a method for computing \(f_{Y - X}\). We visualised both these PDFs in the case \(X, Y \sim U(0, 1)\), and saw that they differed only by a translation along the \(x\)-axis, both having the same pyramid shape. We explained this resemblance, starting from the observation that if \(X \sim U(0,1)\), then \(1-X=-X\). Finally, we were able to visualise the convolution \(f_{X+Y}\) as the intersection area of two colliding rectanlges in the plane, explaining the pyramid shape.</p><p>In this post, we consider the formula for linear combinations \(f_{aX + bY}\). The resulting shape will be a “pyramid with plateau”, whose flat portion is of length \(\lvert b - a \rvert\).</p><h2 id="2-affine-transformations-of-random-variables">2. Affine transformations of random variables</h2><p>We want to compute the PDF of \(Z := aX + bY\), where \(a, b \in \mathbb{R}\) are arbitrary. To do this, we derive some simple rules describing how a PDF changes as the underyling random variable is scaled and translated. If \(a\) is positive, then the conditions \(aX \le x\) and \(X \le x/a\) are equivalent, so</p><p>\begin{align} F_{aX}(x) &amp;= \mathbb{Pr}(aX \le x) = \mathbb{Pr} \left( X \le \frac{x}{a} \right) = F_{X} \left( \frac{x}{a} \right), \quad \textrm{implying} \newline f_{aX}(x) &amp;= \frac{d}{dx} F_{X} \left( \frac{x}{a} \right) = \frac{1}{a} f_{X} \left( \frac{x}{a} \right). \end{align}</p><p>If \(a\) is negative, then \(aX \le x\) is the same as \(X \ge x/a\), so</p><p>\begin{align} F_{aX}(x) &amp;= \mathbb{Pr}(aX \le x) = \mathbb{Pr}\left( X \ge \frac{x}{a} \right) = 1 - \mathbb{Pr}\left( X \le \frac{x}{a} \right) = 1 - F_{X} \left( \frac{x}{a} \right), \quad \textrm{implying} \newline f_{aX}(x) &amp;= \frac{d}{dx} F_{X} \left( \frac{x}{a} \right) = -\frac{1}{a} f_{X} \left( \frac{x}{a} \right). \end{align}</p><p>We can group the two cases together:</p><p>\begin{align} f_{aX}(x) &amp;= \left\vert \frac{1}{a} \right\vert f_{X} \left( \frac{x}{a} \right). \end{align}</p><h2 id="3-simplifying-the-integrand-of-the-convolution">3. Simplifying the integrand of the convolution</h2><p>We’ll use the identities from the previous section to simplify the integrand of the convolution \(f_{aX + bY}\), in the case where \(X, Y \sim U(0, 1)\). By the definition of convolution, we have:</p><p>\begin{align} f_{aX+bY}(z) &amp;= \int_{-\infty}^{\infty} f_{aX}(x) \, f_{bY}(z-x) \, dx. \end{align}</p><p>Inside the integrand, \(z\) functions as a constant. Since \(X, Y \sim U(0, 1)\), the factors \(f_{aX}\) and \(f_{bY}\) in the integrand are indicator functions. Let’s apply the rules from the previous section to rewrite them. The first factor looks like:</p><p>\begin{align} f_{aX}(x) &amp;= \left\vert \frac{1}{a} \right\vert f \left( \frac{x}{a} \right) = \left\vert \frac{1}{a} \right\vert {\mathbb{1}}_{[0, 1]} \left( \frac{x}{a} \right) = \left\{ \begin{array}{ll} \left\vert \frac{1}{a} \right\vert {\mathbb{1}}_{[0, a]}(x), &amp; \textrm{if } a &gt; 0, \newline \left\vert \frac{1}{a} \right\vert {\mathbb{1}}_{[a, 0]}(x), &amp; \textrm{if } a &lt; 0. \end{array} \right. \end{align}</p><p>The last equality follows because \(0 \le \frac{x}{a} \le 1\) is equivalent either to \(0 \le x \le a\) or \(a \le x \le 0\), depending on the sign of \(a\). The second factor is:</p><p>\begin{align} f_{bY}(z-x) &amp;= \left\vert \frac{1}{b} \right\vert f_{Y} \left( \frac{z-x}{b} \right) =<br /> \left\vert \frac{1}{b} \right\vert {\mathbb{1}}_{[0, 1]} \left( \frac{z-x}{b} \right) = \left\{ \begin{array}{ll} \left\vert \frac{1}{b} \right\vert {\mathbb{1}}_{[z-b, z]}(x), &amp; \textrm{if } b &gt; 0, \newline \left\vert \frac{1}{b} \right\vert {\mathbb{1}}_{[z, z-b]}(x), &amp; \textrm{if } b &lt; 0. \end{array} \right. \end{align}</p><p>The last equality follows because \(0 \le \frac{z-x}{b} \le 1\) is equivalent either to \(z-b \le x \le z\) or \(z \le x \le z-b\), depending on the sign of \(b\). Our calculations say the integrand takes slightly different forms in each of the four cases \(a, b \in \{ +1, -1 \}\), but the difference affects only the order in which the endpoints of the intervals in the indicator functions are written. To accommodate this, we write the integrand in a unified form, using some non-standard notation:</p><p>\begin{align} f_{aX+bY}(z) = \left\vert \frac{1}{ab} \right\vert \int_{-\infty}^{\infty} {\mathbb{1}}_{I}(x) \, {\mathbb{1}}_{J}(x) \, dx = \left\vert \frac{1}{ab} \right\vert \int_{-\infty}^{\infty} {\mathbb{1}}_{I \cap J}(x) \, dx, \end{align}</p><p>where:</p><p>\begin{align} I &amp;:= \textrm{sgn}(a)[0, a] = \left\{ \begin{array}{ll} \lbrack 0, a \rbrack, &amp; \textrm{if } a &gt; 0, \newline \lbrack a, 0 \rbrack, &amp; \textrm{if } a &lt; 0, \end{array} \right. \end{align}</p><p>and the meaning of \(J := \textrm{sgn}(b)[z-b, z]\) is similar.</p><h2 id="4-computing-the-convolution-integral">4. Computing the convolution integral</h2><p>To actually compute this integral, of course, we still need to distinguish the four cases \(a, b \in \{ +1, -1 \}\). I will do this here only for the case where \(a\) and \(b\) are both positive. We set \(I := [0, a]\) and \(J := [z-b, z]\), note that \(I\) and \(J\) have lengths \(a\) and \(b\), respectively, and consider how \(I \cap J\) depends on \(z\). Technically, there are two more subcases: Either \(0 &lt; a &lt; b\), or \(0 &lt; b &lt; a\). However, the setup is symmetric in \(a\) and \(b\): Since \(X\) and \(Y\) are both \(\sim U(0, 1)\), it follows \(aX + bY = aY + bX\) as random variables. This means we can compute the convolution integral in either case and simply swap \(a\) and \(b\) to obtain the formula in the other case. So, we suppose \(0 &lt; a &lt; b\), meaning that \(J\) can contain \(I\) for certain values of \(z\). Then</p><p>\begin{align} I \cap J = \left\{ \begin{array}{ll} \emptyset, &amp; \textrm{if } z \le 0, \; \textrm{or} \; z \ge a+b, \newline [z-b, a], &amp; \textrm{if } b \le z \le a+b, \newline [0, a], &amp; \textrm{if } a \le z \le b, \newline [0, z], &amp; \textrm{if } 0 \le z \le a. \end{array} \right. \end{align}</p><p>Geometrically, the first condition means that the intervals \(I\) and \(J\) do not overlap. In the other three cases, they do. In the second case, \(I\) is left of \(J\) and partially overlaps; in the third, \(I\) is contained in \(J\), so the overlap is all of \(I\); in the last case, \(I\) is right of \(J\) with partial overlap. The piecemeal formula for \(I \cap J\) implies:</p><p>\begin{align} f_{aX+bY}(z) &amp;= \left \lvert \frac{1}{ab} \right \rvert \int_{-\infty}^{\infty} \mathbb{1}_{I \cap J}(x) \, dx = \left\{ \begin{array}{ll} 0, &amp; \textrm{if } z \le 0, \; \textrm{or} \; z \ge a+b, \newline \frac{a+b-z}{\lvert ab \rvert}, &amp; \textrm{if } b \le z \le a+b, \newline \frac{1}{\lvert b \rvert}, &amp; \textrm{if } a \le z \le b, \newline \frac{z}{\lvert ab \rvert}, &amp; \textrm{if } 0 \le z \le a. \end{array} \right. \end{align}</p><p>We graph this below using the code in the next cell, familiar from last time.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>  
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="k">def</span> <span class="nf">_set_ax_colour</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">colour</span><span class="p">):</span>
    <span class="s">"""Set the spine, label and ticks of the 
    axis colour to `colour`"""</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">spines</span><span class="p">[</span><span class="s">'bottom'</span><span class="p">].</span><span class="n">set_color</span><span class="p">(</span><span class="n">colour</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">spines</span><span class="p">[</span><span class="s">'top'</span><span class="p">].</span><span class="n">set_color</span><span class="p">(</span><span class="n">colour</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">spines</span><span class="p">[</span><span class="s">'left'</span><span class="p">].</span><span class="n">set_color</span><span class="p">(</span><span class="n">colour</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">spines</span><span class="p">[</span><span class="s">'right'</span><span class="p">].</span><span class="n">set_color</span><span class="p">(</span><span class="n">colour</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">colour</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">colour</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">title</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">colour</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'x'</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colour</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'y'</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colour</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">graph_piecemeal</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="n">formulae</span><span class="p">,</span> <span class="n">resolution</span><span class="p">,</span> <span class="n">figsize</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="s">"""Display a piecemeal graph defined by the list of 
    strings `formulae`, separated by the list of numbers 
    `boundaries`. Each piece of the x_axis is broken into 
    `resolution` parts for graphing. There must be one less 
    formula than boundary."""</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">formulae</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    
    <span class="c1"># setup axes for dark background
</span>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="n">_set_ax_colour</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s">'white'</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    
    <span class="c1"># define `intervals` as consecutive boundary points.
</span>    <span class="n">intervals</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">resolution</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">intervals</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">formulae</span><span class="p">)</span>
    
    <span class="c1"># graph pieces (= (interval, formula) pairs) in a loop
</span>    <span class="k">for</span> <span class="n">interval</span><span class="p">,</span> <span class="n">formula</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">intervals</span><span class="p">,</span> <span class="n">formulae</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">formula</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'blue'</span><span class="p">)</span>
        
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1"># Define the boundaries between the formulae. They correspond to the five regions
# z &lt; 0, 0 &lt; z &lt; a, a &lt; z &lt; b, b &lt; z &lt; a + b, z &gt; a+b in the definition f_{aX+bY}
</span><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>
<span class="n">boundaries</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">d</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">d</span><span class="p">]</span>

<span class="c1"># Define the different formulae for each region
#formulae = ['x*0', 'x', 'x-x+a', 'a+b-x', 'x*0']
</span><span class="n">formulae</span> <span class="o">=</span> <span class="p">[</span><span class="s">'x*0'</span><span class="p">,</span> <span class="s">'x/abs(a*b)'</span><span class="p">,</span> <span class="s">'(x-x+1)/(abs(b))'</span><span class="p">,</span> <span class="s">'(a+b-x)/abs(a*b)'</span><span class="p">,</span> <span class="s">'x*0'</span><span class="p">]</span>
<span class="n">resolution</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">title</span> <span class="o">=</span> <span class="s">'PDF of aX+bY, where X and Y uniform'</span>
<span class="n">graph_piecemeal</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="n">formulae</span><span class="p">,</span> <span class="n">resolution</span><span class="p">,</span> <span class="n">figsize</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/enrightward.github.io/assets/img/convolutions/indicator_ab.png" alt="png" /></p><p>This time, the PDF has the shape of a flattened pyramid. The plateau on top ranges between \(a=2\) and \(b=10\) (and since the roles of \(X\) and \(Y\) are symmetric in this formula, it would range between \(b\) and \(a\) if \(b\) were the smaller constant).</p><h2 id="5-visualising-this-integral">5. Visualising this integral</h2><p>As in the <a href="https://enrightward.github.io/enrightward.github.io/posts/convolutions-part-1/">previous post</a>, we can both explain this shape in words, and visualise it (below, in the next cell) with the <a href="https://www.desmos.com/">desmos calculator</a>. Verbal explanation: The integral</p><p>\begin{align} f_{aX+bY}(z) &amp;= \left \lvert \frac{1}{ab} \right \rvert \int_{-\infty}^{\infty} \mathbb{1}_{I \cap J}(x) \, dx \end{align}</p><p>where \(I := [0, a]\) and \(J := [z-b, z]\), invites us to consider the snapshot at time \(t=z\) as two rectangles of (in general) differing height and width collide, then pass through each other. Indeed, the integrand \(\mathbb{1}_{I \cap J}(x)\) computes the area of this intersection as a function of \(t=z\) (note that the position of \(J\) depends on \(z\)). As \(J\) approaches \(I\) from the left, there is at first no overlap, then collision, then a steadily, linearly increasing overlap until the wider of \(I\) and \(J\) contains the other, then a plateau as the narrower of the two passes inside the wider, then a symmetrical process of linearly decreasing intersection until \(J\) leaves \(I\) forever.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/enrightward.github.io/assets/img/convolutions/ab-indicator.gif" alt="gif" /></p><h2 id="6-roundup">6. Roundup</h2><p>We computed the PDF of an arbitrary linear combination \(Z := aX + bY\) of uniform random variables \(X\) and \(Y\). Algebraically, it is an unpleasant-looking piecemeal function, but visually, it’s just a flattened pyramid. We explained this shape with a story about the intersection area of non-identical colliding rectangles, and visualised this story using a <a href="https://www.desmos.com/">desmos graphical calculator</a>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/enrightward.github.io/categories/statistics/'>statistics</a>, <a href='/enrightward.github.io/categories/convolutions/'>convolutions</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/enrightward.github.io/tags/statistics/" class="post-tag no-text-decoration" >statistics</a> <a href="/enrightward.github.io/tags/convolutions/" class="post-tag no-text-decoration" >convolutions</a> <a href="/enrightward.github.io/tags/uniform-distribution/" class="post-tag no-text-decoration" >uniform distribution</a> <a href="/enrightward.github.io/tags/linear-combinations-random-variables/" class="post-tag no-text-decoration" >linear combinations random variables</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Convolutions of RVs — Part 2: A linear combination of uniform RVs - Logical Quantifier&url=https://enrightward.github.io/enrightward.github.io/posts/convolutions-part-2/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Convolutions of RVs — Part 2: A linear combination of uniform RVs - Logical Quantifier&u=https://enrightward.github.io/enrightward.github.io/posts/convolutions-part-2/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Convolutions of RVs — Part 2: A linear combination of uniform RVs - Logical Quantifier&url=https://enrightward.github.io/enrightward.github.io/posts/convolutions-part-2/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/enrightward.github.io/posts/convolutions-part-2/">Convolutions of RVs — Part 2: A linear combination of uniform RVs</a><li><a href="/enrightward.github.io/posts/order-statistics-part-3/">Order statistics — Part 3: Proof of expectation formula for uniform RVs</a><li><a href="/enrightward.github.io/posts/cross-entropy-part-2/">Cross entropy — Part 2: Convexity of the objective function</a><li><a href="/enrightward.github.io/posts/cross-entropy-part-1/">Cross entropy — Part 1: Introduction and definitions</a><li><a href="/enrightward.github.io/posts/order-statistics-part-2/">Order statistics — Part 2: General formulae for PDFs and expectations</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/enrightward.github.io/tags/statistics/">statistics</a> <a class="post-tag" href="/enrightward.github.io/tags/uniform-distribution/">uniform distribution</a> <a class="post-tag" href="/enrightward.github.io/tags/order-statistics/">order statistics</a> <a class="post-tag" href="/enrightward.github.io/tags/convolutions/">convolutions</a> <a class="post-tag" href="/enrightward.github.io/tags/cross-entropy/">cross entropy</a> <a class="post-tag" href="/enrightward.github.io/tags/beta-function/">beta function</a> <a class="post-tag" href="/enrightward.github.io/tags/convexity/">convexity</a> <a class="post-tag" href="/enrightward.github.io/tags/entropy/">entropy</a> <a class="post-tag" href="/enrightward.github.io/tags/expectation-formula/">expectation formula</a> <a class="post-tag" href="/enrightward.github.io/tags/ftc/">FTC</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/enrightward.github.io/posts/convolutions-part-1/"><div class="card-body"> <span class="timeago small" > Mar 14 <i class="unloaded">2021-03-14T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Convolutions of random variables — Part 1: Introduction</h3><div class="text-muted small"><p> 1. Introduction Suppose that \(X\) and \(Y\) are two continuous random variables. Given their PDFs PDFs \(f_{X}\) and \(f_{Y}\), how do you compute the \(f_{X + Y}\) of the sum of \(X+Y\)? In th...</p></div></div></a></div><div class="card"> <a href="/enrightward.github.io/posts/order-statistics-part-1/"><div class="card-body"> <span class="timeago small" > Mar 5 <i class="unloaded">2021-03-05T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Order statistics — Part 1: Introduction and definitions</h3><div class="text-muted small"><p> 1. Introduction On average, how tall is the tallest 8th grader in a class of 30 students, in the US? What is the value of the average winning bid in a Vickery Auction, where the highest bidder w...</p></div></div></a></div><div class="card"> <a href="/enrightward.github.io/posts/order-statistics-part-2/"><div class="card-body"> <span class="timeago small" > Mar 7 <i class="unloaded">2021-03-07T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Order statistics — Part 2: General formulae for PDFs and expectations</h3><div class="text-muted small"><p> 1. Introduction In the last post, we defined the order statistics of a collection of iid random variables \(X_{1}, \ldots, X_{n}\), to try and answer questions like “What’s the expected value of...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/enrightward.github.io/posts/convolutions-part-1/" class="btn btn-outline-primary" prompt="Older"><p>Convolutions of random variables — Part 1: Introduction</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/username">Stephen Enright-Ward</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/enrightward.github.io/tags/statistics/">statistics</a> <a class="post-tag" href="/enrightward.github.io/tags/uniform-distribution/">uniform distribution</a> <a class="post-tag" href="/enrightward.github.io/tags/order-statistics/">order statistics</a> <a class="post-tag" href="/enrightward.github.io/tags/convolutions/">convolutions</a> <a class="post-tag" href="/enrightward.github.io/tags/cross-entropy/">cross entropy</a> <a class="post-tag" href="/enrightward.github.io/tags/beta-function/">beta function</a> <a class="post-tag" href="/enrightward.github.io/tags/convexity/">convexity</a> <a class="post-tag" href="/enrightward.github.io/tags/entropy/">entropy</a> <a class="post-tag" href="/enrightward.github.io/tags/expectation-formula/">expectation formula</a> <a class="post-tag" href="/enrightward.github.io/tags/ftc/">FTC</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/enrightward.github.io/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://enrightward.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
